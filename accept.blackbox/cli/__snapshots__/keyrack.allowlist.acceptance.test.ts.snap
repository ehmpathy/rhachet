// Jest Snapshot v1, https://jestjs.io/docs/snapshot-testing

exports[`keyrack allowlist given: [case1] repo with allowlist (keyrack.yml) that excludes a key configured on host when: [t0.1] get --key ALLOWED_KEY (human readable) then: stdout matches snapshot 1`] = `
"
ğŸ” rhachet/keyrack
   â””â”€ ALLOWED_KEY
      â”œâ”€ vault: os.direct
      â”œâ”€ mech: REPLICA
      â””â”€ status: granted ğŸ”‘
done. 1 granted.

"
`;

exports[`keyrack allowlist given: [case1] repo with allowlist (keyrack.yml) that excludes a key configured on host when: [t0] get --key ALLOWED_KEY (in allowlist, on host) then: stdout matches snapshot 1`] = `
{
  "grant": {
    "key": {
      "grade": {
        "duration": "permanent",
        "protection": "plaintext",
      },
      "secret": "allowed-key-value-123",
    },
    "slug": "ALLOWED_KEY",
    "source": {
      "mech": "REPLICA",
      "vault": "os.direct",
    },
  },
  "status": "granted",
}
`;

exports[`keyrack allowlist given: [case1] repo with allowlist (keyrack.yml) that excludes a key configured on host when: [t1.1] get --key SECRET_KEY (human readable) then: stdout matches snapshot 1`] = `
"
ğŸ” rhachet/keyrack
   â””â”€ SECRET_KEY
      â””â”€ status: absent ğŸ«§
         â””â”€ fix: add 'SECRET_KEY' to .agent/keyrack.yml
done. 1 absent.

"
`;

exports[`keyrack allowlist given: [case1] repo with allowlist (keyrack.yml) that excludes a key configured on host when: [t1] get --key SECRET_KEY (on host but NOT in allowlist) then: stdout matches snapshot 1`] = `
{
  "fix": "add 'SECRET_KEY' to .agent/keyrack.yml",
  "message": "key 'SECRET_KEY' not found in repo manifest",
  "slug": "SECRET_KEY",
  "status": "absent",
}
`;

exports[`keyrack allowlist given: [case1] repo with allowlist (keyrack.yml) that excludes a key configured on host when: [t2] get --key NONEXISTENT_KEY (not in allowlist, not on host) then: stdout matches snapshot 1`] = `
{
  "fix": "add 'NONEXISTENT_KEY' to .agent/keyrack.yml",
  "message": "key 'NONEXISTENT_KEY' not found in repo manifest",
  "slug": "NONEXISTENT_KEY",
  "status": "absent",
}
`;
