# blackbox criteria matrix: rhx autocomplete

## matrix.1 = tab completion

| ind: partial input | ind: match count | dep: zsh behavior |
|--------------------|------------------|-------------------|
| `rhx git.` | multiple matches | show all matches |
| `rhx git.commit.` | multiple matches | show all matches |
| `rhx git.commit.s` | 2 matches | show: set, uses |
| `rhx perf.t` | 1 match | complete to `perf.test` |
| `rhx nonexistent` | 0 matches | show no completions |

**gap check**: ✅ all match-count cases covered (0, 1, many)

---

## matrix.2 = cwd-aware completions

| ind: cwd repo | ind: skill location | dep: completion visible |
|---------------|---------------------|-------------------------|
| repoA | skill in repoA | yes |
| repoA | skill in repoB | no |
| repoB | skill in repoA | no |
| repoB | skill in repoB | yes |

**gap check**: ✅ cross-repo isolation verified

---

## matrix.3 = rhx list

| ind: --repo | ind: --role | ind: --output | dep: output content |
|-------------|-------------|---------------|---------------------|
| (none) | (none) | (none) | all skills, tree format |
| `.this` | (none) | (none) | repo=.this skills only |
| (none) | `mechanic` | (none) | role=mechanic skills only |
| `.this` | `mechanic` | (none) | repo=.this + role=mechanic |
| (none) | (none) | `tree` | all skills, tree format |
| (none) | (none) | `flat` | all skills, one per line |
| (none) | (none) | `json` | all skills, JSON array |

| ind: .agent/ state | dep: output | dep: exit code |
|--------------------|-------------|----------------|
| has skills | skill list | 0 |
| no .agent/ dir | "no skills found" | 0 |

**gap check**: ✅ filter combinations covered; empty state covered

---

## matrix.4 = rhx search

| ind: query | ind: --scope | ind: --output | dep: output content |
|------------|--------------|---------------|---------------------|
| `commit` | (none) | (none) | skills + briefs with "commit" |
| `commit` | `skills` | (none) | skills only |
| `commit` | `briefs` | (none) | briefs only |
| `commit` | `all` | (none) | skills + briefs |
| `commit` | (none) | `tree` | grouped output |
| `commit` | (none) | `json` | JSON array |

| ind: query match | dep: output | dep: exit code |
|------------------|-------------|----------------|
| matches found | matched results | 0 |
| no matches | "no matches for '...'" | 0 |

**gap check**: ✅ scope × output combinations covered; empty result covered

---

## matrix.5 = rhachet completion

| ind: shell arg | dep: output |
|----------------|-------------|
| `zsh` | valid zsh completion code |

| ind: .agent/ state | dep: completions generated |
|--------------------|---------------------------|
| has skills | includes all skill names |
| no skills | empty completion list |
| skills changed | fresh list on re-rhachet completion --setup|

**gap check**: ✅ single shell (zsh), refresh via re-eval

---

## matrix.6 = first-time setup

| ind: shell | ind: ~/.zshrc state | dep: after `source ~/.zshrc` |
|------------|---------------------|------------------------------|
| zsh | ran `rhachet completion --setup` | tab completion works |
| zsh | no completion setup | tab completion absent |

**gap check**: ✅ setup path covered

---

## decomposition notes

**dimensions per matrix:**
- tab completion: 2 dimensions ✅
- cwd-aware: 2 dimensions ✅
- rhx list: 3 dimensions (repo, role, output) ✅
- rhx search: 3 dimensions (query, scope, output) ✅
- completions: 1-2 dimensions ✅
- setup: 2 dimensions ✅

**no decomposition needed** — all matrices have ≤3 independent dimensions

---

## summary

| usecase | dimensions | combinations | gaps |
|---------|------------|--------------|------|
| tab completion | 2 | 5 | none |
| cwd-aware | 2 | 4 | none |
| rhx list | 3 | 7 + 2 | none |
| rhx search | 3 | 6 + 2 | none |
| completions | 1-2 | 4 | none |
| setup | 2 | 2 | none |

all behavioral combinations accounted for ✅
