# gap report: blueprint v1 self-review (SUPERSEDED)

> **note**: this report was incomplete. see `3.3.blueprint.v1.i2.gap-report.md` for full gap analysis with 14 gaps found and fixed.

## gaps detected (partial)

### gap.1 = brief search not implemented

**criteria**: matrix.4 shows `--scope briefs` and `--scope all` options
```
| `commit` | (none) | (none) | skills + briefs with "commit" |
| `commit` | `briefs` | (none) | briefs only |
```

**vision**: usecase.2 shows brief results in search output
```
briefs:
  practices/work.flow/tools/rule.prefer.allowlist-examples.md
    → mentions: git.commit.set examples
```

**blueprint gap**: `filterSkillsByQuery` only filters skills. no brief discovery or filter.

**fix required**:
1. add `discoverBriefFiles({ slugRepo?, slugRole? })` operation
2. add `filterBriefsByQuery({ briefs, query })` operation
3. update `invokeSkillSearch` to handle `--scope briefs|all`

### gap.2 = default search scope incorrect

**criteria**: matrix.4 shows default scope is `all` (skills + briefs)
```
| `commit` | (none) | (none) | skills + briefs with "commit" |
```

**blueprint gap**: default scope is `'skills'`:
```typescript
.option('--scope <what>', 'scope: skills, briefs, all', 'skills')
```

**fix required**: change default to `'all'`

---

## confirmed coverage

### vision usecases

| usecase | coverage |
|---------|----------|
| usecase.1: discover skills (`rhx list`) | ✅ fully covered |
| usecase.2: search by keyword (`rhx search`) | ⚠️ skills only, briefs gap |
| usecase.3: tab completion | ✅ fully covered |
| usecase.4: interactive fuzzy search | ✅ marked as stretch in vision |

### criteria blackbox episodes

| episode | coverage |
|---------|----------|
| complete partial skill name | ✅ |
| cwd-aware completions | ✅ |
| list all skills | ✅ |
| search by keyword | ⚠️ skills only |
| generate completion code | ✅ |
| first-time setup | ✅ |

### matrix coverage

| matrix | coverage |
|--------|----------|
| matrix.1 tab completion | ✅ |
| matrix.2 cwd-aware | ✅ |
| matrix.3 rhx list | ✅ |
| matrix.4 rhx search | ⚠️ scope briefs/all gap |
| matrix.5 rhachet completion | ✅ |
| matrix.6 first-time setup | ✅ |

---

## resolution (partial)

⚠️ gaps 1-2 fixed in initial review, but 12 more gaps were found in thorough review:

1. added `discoverBriefFiles` operation to scan `.agent/repo=*/role=*/briefs/**/*.md`
2. added `filterBriefsByQuery` operation to match briefs by path and content
3. changed default scope from `'skills'` to `'all'`

**see `3.3.blueprint.v1.i2.gap-report.md` for complete resolution of all 14 gaps.**
