# blueprint v1 junior review

## review date: 2026-02-26

this document reviews the blueprint as if a junior developer worked on it, to flag gaps and issues.

---

## review checklist

### criteria coverage

reviewed each usecase from criteria document against blueprint:

#### usecase.1 = tab completion

| criteria | junior implementation | review status |
|----------|----------------------|---------------|
| `rhx git.<tab>` shows skills that start with "git." | `_rhx()` calls `rhachet completion --list`, zsh `_describe` handles prefix | ✅ correct |
| `rhx git.commit.<tab>` completes to common prefix | zsh native behavior | ✅ correct |
| `rhx git.commit.s<tab>` shows options | zsh native behavior | ✅ correct |
| `rhx nonexistent<tab>` shows no results | zsh `_describe` returns empty | ✅ correct |
| cwd-aware: repoA shows different skills than repoB | dynamic completion via `--list` runs in cwd | ✅ correct |

#### usecase.2 = rhx list

| criteria | junior implementation | review status |
|----------|----------------------|---------------|
| tree grouped by repo/role | `formatAsTree` with groupKey | ✅ correct |
| shows name and .what | `getAllSkillsWithEntries` + `getSkillWhatLine` | ✅ correct |
| `--repo` filter | `discoverSkillExecutables({ slugRepo })` | ✅ correct |
| `--role` filter | `discoverSkillExecutables({ slugRole })` | ✅ correct |
| `--output json` | `formatAsJson` | ✅ correct |
| no skills found message | `if (length === 0) console.log(...)` | ✅ correct |

#### usecase.3 = rhx search

| criteria | junior implementation | review status |
|----------|----------------------|---------------|
| search by name or description | `getSkillsMatchedByQuery` checks both | ✅ correct |
| context snippets | `getBriefsMatchedByQuery` + `getSnippetFromContent` | ✅ correct |
| `--scope skills` filter | conditional in action | ✅ correct |
| no matches message | `console.log('no matches for ...')` | ✅ correct |

#### usecase.4 = rhachet completion

| criteria | junior implementation | review status |
|----------|----------------------|---------------|
| valid zsh code | `genZshCompletionCode()` | ✅ correct |
| code can be eval'd | valid syntax with #compdef, _describe | ✅ correct |
| cache refresh via init | N/A — dynamic completion, no cache | ✅ correct (approach changed) |

#### usecase.5 = first-time setup

| criteria | junior implementation | review status |
|----------|----------------------|---------------|
| one-liner setup | `rhachet completion --setup` | ✅ correct |

---

### exchange contracts verification

#### rhx list contracts

| contract | junior implementation | review status |
|----------|----------------------|---------------|
| (no args) → tree | default format | ✅ correct |
| `--repo` → filtered | `discoverSkillExecutables` | ✅ correct |
| `--role` → filtered | `discoverSkillExecutables` | ✅ correct |
| `--output tree` | `formatAsTree` | ✅ correct |
| `--output flat` | `formatAsFlat` | ✅ correct |
| `--output json` | `formatAsJson` | ✅ correct |

#### rhx search contracts

| contract | junior implementation | review status |
|----------|----------------------|---------------|
| `<query>` → matches | query functions | ✅ correct |
| `--scope skills` → skills only | conditional | ✅ correct |
| `--scope briefs` → briefs only | conditional | ✅ correct |
| `--scope all` → both | default | ✅ correct |
| `--output tree` → grouped | `formatSearchResults` | ✅ correct |
| `--output json` → JSON | `formatSearchResults` | ✅ correct |

#### rhachet completion contracts

| contract | junior implementation | review status |
|----------|----------------------|---------------|
| `zsh` → zsh code | `genZshCompletionCode()` | ✅ correct |

#### tab completion contracts

| contract | junior implementation | review status |
|----------|----------------------|---------------|
| `rhx <partial><tab>` | `_rhx()` via `_describe` | ✅ correct |
| `rhx <partial><tab><tab>` | zsh native | ✅ correct |
| `rhachet run --skill <partial><tab>` | `_rhachet_run_skill()` | ✅ correct |

---

### error cases verification

| error case | junior implementation | review status |
|------------|----------------------|---------------|
| no .agent/ | "no skills found in .agent/" | ✅ correct |
| invalid --output | `assertValidOption` throws | ✅ correct |
| invalid --scope | `assertValidOption` throws | ✅ correct |
| empty query | returns all items | ✅ correct |

---

### code quality review

#### name conventions

| check | status |
|-------|--------|
| get verb for operations | ✅ `getAllSkillsWithEntries`, `getSkillsMatchedByQuery`, `getBriefsMatchedByQuery` |
| queryLowercased (not queryLower) | ✅ line 542, 663 |
| pathMatched/contentMatched (not pathMatch) | ✅ lines 677-678 |
| .why on types | ✅ types.ts lines 227-269 |

#### patterns

| check | status |
|-------|--------|
| flatMap for functional composition | ✅ getAllMdFilesRecursive, getAllBriefFiles, formatAsTree |
| try/catch for file reads | ✅ getSkillWhatLine, getBriefsMatchedByQuery |
| let mutation comments | ✅ documented in gap.38 |
| combined types (SkillWithEntry) | ✅ no parallel arrays |

#### binary route

| check | status |
|-------|--------|
| completions → rhachet-roles.bc | ✅ gap.41 fix in bin/run.bun |
| performance (~70ms) | ✅ same binary as roles boot |

---

### acceptance tests review

| test | coverage | status |
|------|----------|--------|
| zsh interface contract | #compdef, _rhx(), _describe, --list call | ✅ specified |
| cwd-aware behavior | repoA vs repoB fixtures | ✅ specified |

---

## gaps found

**no gaps detected.**

the junior implementation is complete and correct:
- all criteria covered
- all exchange contracts specified
- all error cases handled
- code follows practices (name, patterns, route)
- acceptance tests specified

---

## conclusion

the blueprint is ready for implementation. the junior work is thorough and follows all practices.

