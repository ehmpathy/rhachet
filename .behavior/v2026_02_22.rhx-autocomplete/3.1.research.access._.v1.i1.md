# research: access requirements

## summary

the rhx autocomplete feature requires **no remote access**. all data sources are local:

1. **local filesystem** ‚Äî scan `.agent/` for skills
2. **zsh completion system** ‚Äî integrate with shell completion framework

---

## access.1 = local filesystem (.agent/)

### what

scan `.agent/repo=*/role=*/skills/` directories to discover available skills.

### contract

```
input: cwd (current repo root)
output: list of skill paths
  - .agent/repo=.this/role=any/skills/*.sh
  - .agent/repo=ehmpathy/role=mechanic/skills/*.sh
  - etc.
```

### interface

- node.js `fs` module (readdir, stat)
- or shell: `find .agent -name "*.sh" -path "*/skills/*"`

### best practices

1. **detect repo root** via presence of `.agent/` or `.git/`
2. **follow symlinks** ‚Äî linked roles point to node_modules
3. **cache results** ‚Äî avoid repeated scans on every tab

---

## access.2 = zsh completion system

### what

integrate with zsh's programmable completion framework to provide tab completion for `rhx` and `rhachet run --skill`.

### contract

zsh expects completion functions in specific format:

```zsh
#compdef rhx

_rhx() {
  local -a skills
  skills=(
    'git.commit.set:create git commit'
    'perf.test:measure CLI time'
    # ...
  )
  _describe 'skill' skills
}

_rhx "$@"
```

### interface

- `compdef` ‚Äî register completion function [1]
- `_describe` ‚Äî display completions with descriptions [1]
- `compadd` ‚Äî add completions programmatically [1]

### best practices

1. **use `_describe`** for skill + description pairs [1]
2. **cache in `$_comps`** or generate dynamically [2]
3. **detect cwd** to scope completions per repo [2]

---

## citations

[1] zsh completion system documentation
- source: https://zsh.sourceforge.io/Doc/Release/Completion-System.html
- quote: "The _describe function is used to display completions together with their descriptions"
- quote: "compdef is used to bind completion functions to commands"

[2] zsh completion best practices (community)
- source: https://github.com/zsh-users/zsh-completions/blob/master/zsh-completions-howto.org
- quote: "For dynamic completions, generate the list at completion time rather than at shell startup"

---

## no remote access needed

| access type | required | reason |
|-------------|----------|--------|
| database | no | skills stored in filesystem |
| external API | no | all data is local |
| network | no | offline-capable |
| cloud storage | no | local .agent/ only |

the feature is fully offline-capable üê¢
