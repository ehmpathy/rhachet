# proposal: sleeker keyrack set output

## goal

sleek unicode tree aesthetics â€” two trees, consistent style, emoji anchors, question headers, whitespace separation

## before

```
ğŸ” keyrack set AWS_PROFILE

   â”œâ”€ âœ“ aws cli installed
   â”‚
   â”œâ”€ âœ“ found 1 sso portal in ~/.aws/config
   â”‚
   â”œâ”€ which sso domain?
   â”‚
   â”‚  options found:
   â”‚    1. https://d-906617ed8b.awsapps.com/start (us-east-1)
   â”‚
   â”‚  reuse one? enter the number. otherwise, enter a custom url.
   â”‚
   â”‚  choice: 1
   â”‚
   â”‚  âœ“ sso_start_url = https://d-906617ed8b.awsapps.com/start
   â”‚  âœ“ sso_region = us-east-1
   â”‚
   â”œâ”€ which sso login?
   â”‚
   â”‚  â³ open browser for device auth...
   â”‚

  ğŸ”— https://d-906617ed8b.awsapps.com/start/#/device
  ğŸ”‘ code: VZBT-KJGT

  âœ“ authenticated

   â”‚
   â”‚  âœ“ browser auth approved
   â”‚
   â”œâ”€ which account?
   â”‚
   â”‚    1. 805192865516 Â· ehmpathy-demo Â· vlad+ehmpathy.demo@ahbode.com
   â”‚
   â”‚  choice: 1
   â”‚
   â”‚  âœ“ sso_account_id = 805192865516
   â”‚
   â”œâ”€ which role?
   â”‚
   â”‚    1. ehmpathy-demo-sso
   â”‚
   â”‚  choice: 1
   â”‚
   â”‚  âœ“ sso_role_name = ehmpathy-demo-sso
   â”‚
   â”œâ”€ what should we call it?
   â”‚
   â”‚  suggested: ehmpathy.demo
   â”‚  accept or enter custom:
   â”‚
   â”‚  âœ“ profile = ehmpathy.demo
   â”‚
   â”œâ”€ âœ“ profile found in ~/.aws/config (equivalent)
   â”‚
   â””â”€ done

   â”‚
   â”œâ”€ validate roundtrip
   â”‚
   â”‚  âœ“ unlock
   â”‚  âœ“ get (value matches)
   â”‚  âœ“ relock
   â”‚
   â”‚  roundtrip validated âœ¨

ğŸ” rhachet/keyrack set (org: ehmpathy, env: test)
   â””â”€ ehmpathy.test.AWS_PROFILE
      â”œâ”€ mech: EPHEMERAL_VIA_AWS_SSO
      â””â”€ vault: aws.iam.sso
done. 1 key(s) configured âœ¨
```

## issues

1. **breaks out of tree** â€” browser auth section escapes tree structure
2. **orphan pipes** â€” `â”‚` on blank lines without purpose
3. **inconsistent indent** â€” mixed spacing throughout
4. **redundant echo** â€” shows choice, then confirms with âœ“

## after (proposed)

```
ğŸ” keyrack set AWS_PROFILE
   â”‚
   â”œâ”€ which sso domain?
   â”‚  â”œâ”€ options
   â”‚  â”‚  â””â”€ 1. https://d-906617ed8b.awsapps.com/start (us-east-1)
   â”‚  â””â”€ choice
   â”‚     â””â”€ 1 âœ“
   â”‚
   â”œâ”€ which sso login?
   â”‚  â”œâ”€ ğŸ”— https://d-906617ed8b.awsapps.com/start/#/device
   â”‚  â”œâ”€ ğŸ”‘ VZBT-KJGT
   â”‚  â””â”€ âœ“ authenticated
   â”‚
   â”œâ”€ which account?
   â”‚  â”œâ”€ options
   â”‚  â”‚  â””â”€ 1. 805192865516 Â· ehmpathy-demo
   â”‚  â””â”€ choice
   â”‚     â””â”€ 1 âœ“
   â”‚
   â”œâ”€ which role?
   â”‚  â”œâ”€ options
   â”‚  â”‚  â””â”€ 1. ehmpathy-demo-sso
   â”‚  â””â”€ choice
   â”‚     â””â”€ 1 âœ“
   â”‚
   â”œâ”€ what should we call it?
   â”‚  â”œâ”€ suggested
   â”‚  â”‚  â””â”€ ehmpathy.demo
   â”‚  â””â”€ choice
   â”‚     â””â”€ ehmpathy.demo âœ“
   â”‚
   â”œâ”€ lovely, lets vault it now...
   â”‚  â””â”€ âœ“ written to ~/.aws/config
   â”‚
   â””â”€ perfect, now lets verify...
      â”œâ”€ âœ“ unlock
      â”œâ”€ âœ“ get
      â””â”€ âœ“ relock

ğŸ” keyrack set (org: ehmpathy, env: test)
   â””â”€ ehmpathy.test.AWS_PROFILE
      â”œâ”€ mech: EPHEMERAL_VIA_AWS_SSO
      â””â”€ vault: aws.iam.sso
```

## tree style

```
ğŸ” root anchor
   â”‚
   â”œâ”€ question header?
   â”‚  â”œâ”€ options
   â”‚  â”‚  â”œâ”€ 1. first option
   â”‚  â”‚  â””â”€ 2. second option
   â”‚  â””â”€ choice
   â”‚     â””â”€ 1 âœ“
   â”‚
   â”œâ”€ question header?
   â”‚  â””â”€ leaf
   â”‚
   â””â”€ final branch
      â”œâ”€ âœ“ leaf
      â”œâ”€ âœ“ leaf
      â””â”€ âœ— failure (if error)
```

- emoji anchor at root
- 3 space offset from root
- question-style headers (`which X?`, `what should we call it?`)
- `â”‚` newline before each `â”œâ”€` section (whitespace separation)
- `â”œâ”€` for branches, `â””â”€` for last
- nested content indented under `â”‚`
- explicit `options` and `choice` subbranches under question headers
- `âœ“` for success and choice confirmation, `âœ—` for failure

## variant: error state

```
ğŸ” keyrack set AWS_PROFILE
   â”‚
   â”œâ”€ which sso domain?
   â”‚  â”œâ”€ options
   â”‚  â”‚  â””â”€ 1. https://d-906617ed8b.awsapps.com/start (us-east-1)
   â”‚  â””â”€ choice
   â”‚     â””â”€ 1 âœ“
   â”‚
   â”œâ”€ which sso login?
   â”‚  â”œâ”€ ğŸ”— https://d-906617ed8b.awsapps.com/start/#/device
   â”‚  â”œâ”€ ğŸ”‘ VZBT-KJGT
   â”‚  â””â”€ âœ— timeout
   â”‚
   â””â”€ hint: approve the login in your browser
```

## implementation

1. two separate trees â€” setup flow, then summary
2. emoji anchor at each root
3. 3 space indent from root
4. question-style headers preserved (`which X?`)
5. `â”‚` newline before each section for whitespace separation
6. browser auth stays inside tree (no break-out)
7. explicit `options` and `choice` subbranches under question headers
8. `âœ“` for success and choice confirmation, `âœ—` for failure
9. friendly vault header: "lovely, lets vault it now..."
10. friendly verification header: "perfect, now lets verify..."
