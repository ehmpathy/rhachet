# research: aws sso confirmation flows - what to call them

## the two flows

based on observed behavior, there are two distinct confirmation flows when a user authenticates via aws sso:

### flow A: oauth client registration flow

**browser prompt**: "Allow access to botocore-client-{name}?"

**characteristics**:
- registers an oauth client with aws sso oidc service
- client name appears in browser confirmation prompt
- uses `register_client` api under the hood
- persists client credentials to cache

**trigger**: (needs verification - what exactly triggers this?)

### flow B: standard sso signin flow

**browser prompt**: standard "Sign in" / "Allow" (no botocore-client mention)

**characteristics**:
- no oauth client registration
- normal human signin experience
- same as direct portal visit to `d-xxxxxxxxxx.awsapps.com/start`
- no client credentials persisted

**trigger**: (needs verification - what exactly triggers this?)

## proposed terminology

| flow | short name | descriptive name |
|------|------------|------------------|
| A | boto flow | oauth client registration flow |
| B | human flow | standard sso signin flow |

or

| flow | short name | descriptive name |
|------|------------|------------------|
| A | programmatic flow | registered client flow |
| B | portal flow | direct signin flow |

## open questions

1. what cli command / config combination triggers flow A vs flow B?
2. does the config format (inline vs sso-session) matter?
3. does the cli flag (`--profile` vs `--sso-session`) matter?
4. is it a version-specific behavior (pre/post v2.22.0)?

## sources

- [aws cli sso configuration](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html)
- [aws cli pkce announcement](https://aws.amazon.com/blogs/developer/aws-cli-adds-pkce-based-authorization-for-sso/)
- [christophe tafani-dereeper pkce analysis](https://blog.christophetd.fr/pkce-aws-sso/)
