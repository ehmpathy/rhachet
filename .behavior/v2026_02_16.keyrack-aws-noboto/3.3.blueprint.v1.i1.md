# blueprint: keyrack aws sso with portal flow (not programmatic flow)

## overview

fix keyrack to use **portal flow** (standard aws sso signin) instead of **programmatic flow** (botocore-client prompt).

ensure all auth uses `--profile` flag for consistent portal flow. vault.set() calls setupAwsSsoProfile for interactive setup.

## primary requirement: keyrack set must validate roundtrip

### layer separation (critical)

**contract layer = thin**
- `src/contract/cli/invokeKeyrack.ts`
- parses cli args
- calls exactly ONE domain operation
- formats output

**domain operations = orchestration + business logic**
- `src/domain.operations/keyrack/`
- orchestrates vault adapter calls
- validates roundtrip
- manages manifests

**vault adapters = atomic operations**
- `set`: store a value
- `get`: retrieve a value
- `unlock`: refresh/activate session
- `relock`: clear session

**rule: CLI must invoke exactly ONE domain operation per CLI command**

| cli command | domain operation | status |
|-------------|------------------|--------|
| `keyrack get` | `getKeyrackKeyGrant` | âœ“ ok |
| `keyrack set` | `setKeyrackKey` | âœ— needs refactor |
| `keyrack unlock` | `unlockKeyrack` | âœ“ ok |
| `keyrack relock` | `relockKeyrack` | âœ“ ok |
| `keyrack status` | `getKeyrackStatus` | âœ“ ok |
| `keyrack list` | (inline) | âš  minor |
| `keyrack init` | `initKeyrackRepoManifest` | âœ“ ok |

the `keyrack set` command currently orchestrates ~10 operations directly in the CLI layer. this violates layer separation. the fix: create `setKeyrackKey.ts` domain operation.

### setKeyrackKey domain operation (new)

the new `setKeyrackKey.ts` domain operation orchestrates the full `keyrack set` flow:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CLI: keyrack set --key AWS_PROFILE --env test --vault aws.iam.sso â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  setKeyrackKey(input, context)  â† single domain operation      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                         â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ vault   â”‚           â”‚ host        â”‚           â”‚ repo        â”‚
â”‚ ops     â”‚           â”‚ manifest    â”‚           â”‚ manifest    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### setKeyrackKey orchestrates roundtrip (for ALL vaults)

```
setKeyrackKey(input, context)
â”œâ”€â”€ 1. vault-specific setup (e.g., setupAwsSsoProfile for aws.iam.sso)
â”‚     â†’ interactive prompts, profile creation, etc.
â”‚
â”œâ”€â”€ 2. vault.set(slug, value)
â”‚     â†’ store the key in vault
â”‚
â”œâ”€â”€ 3. setKeyrackKeyHost()
â”‚     â†’ update host manifest (~/.rhachet/keyrack.*.json)
â”‚
â”œâ”€â”€ 4. roundtrip validation:
â”‚     â”œâ”€â”€ vault.unlock({})
â”‚     â”‚     â†’ prove unlock works
â”‚     â”‚     â†’ for aws.iam.sso: triggers one-time OAuth registration
â”‚     â”‚
â”‚     â”œâ”€â”€ vault.get({ slug })
â”‚     â”‚     â†’ prove get works
â”‚     â”‚     â†’ sanity check: returned value matches what we set
â”‚     â”‚
â”‚     â””â”€â”€ vault.relock({ slug })
â”‚           â†’ clear session
â”‚           â†’ leave vault in locked state after setup
â”‚
â”œâ”€â”€ 5. setKeyrackKeyRepo() [if in repo context]
â”‚     â†’ update repo manifest (.agent/keyrack.yml)
â”‚
â””â”€â”€ return success
```

**this is NOT specific to aws.iam.sso** â€” keyrack set does this roundtrip for EVERY vault adapter. it's a pit-of-success guarantee: if `keyrack set` succeeds, the key is guaranteed to work.

### why this matters for aws.iam.sso

the "botocore-client" OAuth prompt is a **one-time registration** per sso-session. with roundtrip at set:
- OAuth registration happens at setup (user expects prompts at setup)
- future `keyrack unlock` uses portal flow (no surprises)
- misconfigured profiles fail fast at setup, not at unlock time

see: `5.lesson.aws-sso-registration-scopes.md`

## the problem

### wrong auth flow

current implementation at `vaultAdapterAwsIamSso.ts:153` uses:
```ts
['sso', 'login', '--sso-session', ssoSessionName, '--use-device-code'],
```

this triggers **programmatic flow** = "Allow access to botocore-client-{name}?" prompt.

### inconsistent auth logic

auth uses different mechanisms:
1. `setupAwsSsoProfile.ts:92` - uses `--profile` flag âœ“ (portal flow)
2. `setupAwsSsoProfile.ts:308` (initiateAwsSsoAuth) - uses `--profile` flag âœ“
3. `vaultAdapterAwsIamSso.ts:153` - uses `--sso-session` flag âœ— (boto flow)

all auth should use `--profile` flag for consistent portal flow.

## the fix

### 1. use `--profile` flag (portal flow)

```ts
['sso', 'login', '--profile', profileName],  // âœ“ portal flow
```

### 2. vault adapter orchestrates via setupAwsSsoProfile

vault adapter owns the lifecycle:
- vault.set() calls setupAwsSsoProfile() for interactive setup
- setupAwsSsoProfile() handles prompts, profile write, auth, validation
- vault.set() stores the profile name in vault storage
- vault.unlock() uses same triggerSsoLogin(profileName) for refresh

both set and unlock use the same auth mechanism: `--profile` flag â†’ portal flow.

## architecture (after)

```
vaultAdapterAwsIamSso
â”œâ”€â”€ set({ slug, value })
â”‚   â”œâ”€â”€ call setupAwsSsoProfile() for interactive setup
â”‚   â”‚   â”œâ”€â”€ prompt for sso url (or pick from known)
â”‚   â”‚   â”œâ”€â”€ trigger temp auth for enumeration (portal flow)
â”‚   â”‚   â”œâ”€â”€ prompt for account
â”‚   â”‚   â”œâ”€â”€ prompt for role
â”‚   â”‚   â”œâ”€â”€ prompt for profile name
â”‚   â”‚   â”œâ”€â”€ write profile to ~/.aws/config
â”‚   â”‚   â”œâ”€â”€ trigger auth via triggerSsoLogin(profileName) (portal flow)
â”‚   â”‚   â””â”€â”€ validate via validateSsoSession(profileName)
â”‚   â””â”€â”€ store profile name in vault storage
â”‚
â”œâ”€â”€ get({ slug })           # read profile name from storage
â”œâ”€â”€ del({ slug })           # remove profile from storage
â”œâ”€â”€ unlock()                # refresh all expired sessions via triggerSsoLogin
â”œâ”€â”€ isUnlocked()            # check all sessions valid
â””â”€â”€ relock({ slug })        # clear cached credentials

setupAwsSsoProfile (separate operation, called by vault.set)
â”œâ”€â”€ prompt for sso url (or pick from known)
â”œâ”€â”€ trigger temp auth for enumeration (portal flow)
â”œâ”€â”€ prompt for account
â”œâ”€â”€ prompt for role
â”œâ”€â”€ prompt for profile name
â”œâ”€â”€ write profile to ~/.aws/config
â”œâ”€â”€ trigger auth via triggerSsoLogin(profileName) (portal flow)
â””â”€â”€ validate session
```

## filediff treestruct

```
src/
â”œâ”€â”€ contract/cli/
â”‚   â””â”€â”€ [~] invokeKeyrack.ts
â”‚       â””â”€â”€ [~] keyrack set: refactor to call setKeyrackKey() only
â”‚
â”œâ”€â”€ domain.operations/keyrack/
â”‚   â”œâ”€â”€ [+] setKeyrackKey.ts                       # NEW: orchestrates full set flow
â”‚   â”‚   â”œâ”€â”€ vault-specific setup (aws.iam.sso â†’ setupAwsSsoProfile)
â”‚   â”‚   â”œâ”€â”€ vault.set()
â”‚   â”‚   â”œâ”€â”€ setKeyrackKeyHost()
â”‚   â”‚   â”œâ”€â”€ roundtrip validation (unlock â†’ get â†’ relock)
â”‚   â”‚   â””â”€â”€ setKeyrackKeyRepo() [if in repo]
â”‚   â”œâ”€â”€ [+] setKeyrackKey.test.ts                  # NEW: unit tests
â”‚   â”‚
â”‚   â”œâ”€â”€ adapters/vaults/
â”‚   â”‚   â”œâ”€â”€ [~] vaultAdapterAwsIamSso.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ [~] triggerSsoLogin: --profile instead of --sso-session
â”‚   â”‚   â”‚   â”œâ”€â”€ [~] set: call setupAwsSsoProfile, then store in vault
â”‚   â”‚   â”‚   â”œâ”€â”€ [~] unlock: simplified, use triggerSsoLogin(profileName)
â”‚   â”‚   â”‚   â””â”€â”€ [-] getSsoSessionForProfile: delete
â”‚   â”‚   â”œâ”€â”€ [~] vaultAdapterAwsIamSso.test.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ [+] setupAwsSsoProfile.ts              # MOVED from keyrack/
â”‚   â”‚   â”‚   â”œâ”€â”€ [~] triggerSsoLogin: use --profile flag (portal flow)
â”‚   â”‚   â”‚   â””â”€â”€ [â—‹] retain: all interactive prompts, profile write, validation
â”‚   â”‚   â”œâ”€â”€ [+] setupAwsSsoProfile.test.ts         # MOVED from keyrack/
â”‚   â”‚   â””â”€â”€ [+] setupAwsSsoProfile.interactive.test.ts  # MOVED from keyrack/
â”‚   â”‚
â”‚   â”œâ”€â”€ [-] setupAwsSsoProfile.ts                  # DELETE (moved to adapters/vaults/)
â”‚   â”œâ”€â”€ [-] setupAwsSsoProfile.test.ts             # DELETE (moved to adapters/vaults/)
â”‚   â””â”€â”€ [-] setupAwsSsoProfile.interactive.test.ts # DELETE (moved to adapters/vaults/)
```

## codepath treestruct

### vaultAdapterAwsIamSso.ts

```
vaultAdapterAwsIamSso
â”œâ”€â”€ [~] triggerSsoLogin(profileName)
â”‚   â”œâ”€â”€ [-] --sso-session flag           # DELETE
â”‚   â”œâ”€â”€ [-] --use-device-code flag       # DELETE
â”‚   â””â”€â”€ [+] --profile flag               # ADD: portal flow
â”‚
â”œâ”€â”€ [~] set({ slug, value })
â”‚   â”œâ”€â”€ [+] call setupAwsSsoProfile()    # ADD: interactive setup
â”‚   â””â”€â”€ [â—‹] store in vault storage
â”‚
â”œâ”€â”€ [~] unlock()
â”‚   â”œâ”€â”€ [â—‹] for each stored profile:
â”‚   â”‚   â”œâ”€â”€ [â—‹] validate via sts get-caller-identity
â”‚   â”‚   â””â”€â”€ [~] if expired: triggerSsoLogin(profileName)
â”‚   â”œâ”€â”€ [-] getSsoSessionForProfile()    # DELETE: not needed
â”‚   â””â”€â”€ [-] legacy config rejection      # DELETE: not needed
â”‚
â”œâ”€â”€ [â—‹] get()                            # retain
â”œâ”€â”€ [â—‹] del()                            # retain
â”œâ”€â”€ [â—‹] isUnlocked()                     # retain
â””â”€â”€ [â—‹] relock()                         # retain
```

### setupAwsSsoProfile.ts

```
setupAwsSsoProfile                          # called by vault.set()
â”œâ”€â”€ [â—‹] prompt for sso url                  # RETAIN
â”œâ”€â”€ [~] initiateAwsSsoAuth (temp auth)      # RETAIN: use --profile (portal flow)
â”œâ”€â”€ [â—‹] listAwsSsoAccounts                  # RETAIN
â”œâ”€â”€ [â—‹] listAwsSsoRoles                     # RETAIN
â”œâ”€â”€ [â—‹] prompt for account + role           # RETAIN
â”œâ”€â”€ [â—‹] prompt for profile name             # RETAIN
â”œâ”€â”€ [â—‹] write profile to ~/.aws/config      # RETAIN
â”œâ”€â”€ [~] final auth via triggerSsoLogin      # FIX: use --profile (portal flow)
â””â”€â”€ [â—‹] validate session                    # RETAIN
```

## contracts

### setKeyrackKey (new domain operation)

```ts
/**
 * .what = orchestrates the full keyrack set flow
 * .why = single domain operation for CLI to call (layer separation)
 */
export const setKeyrackKey = async (
  input: {
    key: string;
    env: string;
    vault: KeyrackHostVault;
    mech?: KeyrackGrantMechanism;
    exid?: string;
    json?: boolean;
  },
  context: {
    vaultAdapters: VaultAdapters;
    gitroot?: string;
    log: LogMethods;
  },
): Promise<{
  slug: string;
  profileName: string;
  hostUpdated: boolean;
  repoUpdated: boolean;
  roundtripValidated: boolean;
}> => {
  const slug = `${org}.${input.env}.${input.key}`;
  const mech = input.mech ?? inferMechFromVault(input.vault);

  // 1. vault-specific setup (for aws.iam.sso: interactive profile setup)
  const setupResult = await runVaultSpecificSetup({ vault: input.vault, ... });

  // 2. vault.set() â€” store in vault
  await context.vaultAdapters[input.vault].set({ slug, value: setupResult.profileName });

  // 3. setKeyrackKeyHost() â€” update host manifest
  await setKeyrackKeyHost({ slug, mech, vault: input.vault, exid: setupResult.profileName }, ...);

  // 4. roundtrip validation: unlock â†’ get â†’ relock
  await context.vaultAdapters[input.vault].unlock({});
  const valueRead = await context.vaultAdapters[input.vault].get({ slug });
  if (valueRead !== setupResult.profileName) throw new UnexpectedCodePathError(...);
  await context.vaultAdapters[input.vault].relock?.({ slug });

  // 5. setKeyrackKeyRepo() â€” update repo manifest (if in repo context)
  if (context.gitroot) {
    await setKeyrackKeyRepo({ slug, mech }, { gitroot: context.gitroot });
  }

  return { slug, profileName: setupResult.profileName, hostUpdated: true, repoUpdated: !!context.gitroot, roundtripValidated: true };
};
```

### vaultAdapterAwsIamSso.set (updated)

```ts
set: async (input: {
  slug: string;
  value: string;  // profile name (may be overridden by setupAwsSsoProfile)
  exid?: string;
  expiresAt?: string;
}) => {
  // run interactive setup (prompts, profile write, auth, validation)
  const result = await setupAwsSsoProfile({
    suggestedProfileName: input.value,
  });

  // store in vault
  const store = readSsoStore();
  store[input.slug] = {
    profileName: result.profileName,
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString(),
  };
  writeSsoStore(store);
},
```

### triggerSsoLogin (fixed)

```ts
const triggerSsoLogin = async (profileName: string): Promise<void> => {
  return new Promise((resolve, reject) => {
    const child = spawn(
      'aws',
      ['sso', 'login', '--profile', profileName],  // âœ“ portal flow
      { stdio: 'inherit' },
    );
    // ...
  });
};
```

## verification

### manual test

```sh
# step 1: set up profile (should show portal flow)
rhx keyrack set --key AWS_PROFILE --env test --vault aws.iam.sso
# browser: standard "Sign in" / "Allow" âœ“
# browser: NO "botocore-client-{name}" âœ“

# step 2: force relock
rhx keyrack relock --env test

# step 3: unlock (should show portal flow)
rhx keyrack unlock --env test
# browser: standard "Sign in" / "Allow" âœ“
# browser: NO "botocore-client-{name}" âœ“
```

### acceptance criteria

| scenario | auth location | flow |
|----------|---------------|------|
| `keyrack set` | vault.set() | portal âœ“ |
| `keyrack unlock` | vault.unlock() | portal âœ“ |
| temp auth for enumeration | initiateAwsSsoAuth | portal âœ“ |

all auth goes through vault adapter. all auth uses `--profile`. all auth shows portal flow.

## implementation phases

### phase 1: fix triggerSsoLogin in vaultAdapterAwsIamSso âœ“ done

1. change args to `['sso', 'login', '--profile', profileName]`
2. update signature to accept profileName (not ssoSessionName)
3. remove `--use-device-code` flag

### phase 2: fix triggerSsoLogin in setupAwsSsoProfile âœ“ done

1. change final auth to use `--profile` flag (portal flow)
2. change temp auth (initiateAwsSsoAuth) to use `--profile` flag

### phase 3: wire vault.set() to call setupAwsSsoProfile âœ“ done

1. vault.set() calls setupAwsSsoProfile() for interactive setup
2. vault.set() stores result.profileName in vault storage

### phase 4: simplify unlock() âœ“ done

1. delete `getSsoSessionForProfile()` function
2. delete legacy config rejection
3. call `triggerSsoLogin(profileName)` directly

### phase 5: update tests âœ“ done

### phase 6: roundtrip validation âœ“ done (but in wrong layer)

roundtrip validation was added to CLI layer â€” violates layer separation.

### phase 7: layer separation refactor (NEW)

**goal**: CLI invokes exactly ONE domain operation per command.

**tasks**:

1. create `src/domain.operations/keyrack/setKeyrackKey.ts`
   - move all orchestration logic from invokeKeyrack.ts
   - includes: vault-specific setup, vault.set, setKeyrackKeyHost, roundtrip, setKeyrackKeyRepo

2. create `src/domain.operations/keyrack/setKeyrackKey.test.ts`
   - test: set calls vault.set â†’ vault.unlock â†’ vault.get â†’ vault.relock
   - test: set fails if any roundtrip step fails
   - test: set updates host manifest
   - test: set updates repo manifest (if in repo context)

3. refactor `src/contract/cli/invokeKeyrack.ts`
   - `keyrack set` command calls `setKeyrackKey()` only
   - all orchestration logic removed from CLI

**test files**:

- `src/domain.operations/keyrack/setKeyrackKey.test.ts` (NEW)
  - roundtrip validation tests
  - manifest update tests

- `src/domain.operations/keyrack/adapters/vaults/vaultAdapterAwsIamSso.test.ts`
  - remove `--sso-session` expectations
  - remove `--use-device-code` expectations
  - update to use `--profile` flag

- `src/domain.operations/keyrack/adapters/vaults/vaultAdapterAwsIamSso.integration.test.ts`
  - verify portal flow auth (not botocore-client)

- `src/domain.operations/keyrack/adapters/vaults/setupAwsSsoProfile.test.ts`
  - verify `--profile` flag auth

- `src/domain.operations/keyrack/adapters/vaults/setupAwsSsoProfile.interactive.test.ts`
  - verify roundtrip validation at end of setup

## phase 8: sleeker CLI output

**goal**: sleek unicode tree aesthetics for keyrack set output

**see**: `8.proposal.sleeker-output.md`

**tree structure**:
```
ğŸ” keyrack set AWS_PROFILE
   â”‚
   â”œâ”€ which sso domain?
   â”‚  â”œâ”€ options
   â”‚  â”‚  â””â”€ 1. https://d-906617ed8b.awsapps.com/start (us-east-1)
   â”‚  â””â”€ choice
   â”‚     â””â”€ 1 âœ“
   â”‚
   â”œâ”€ which sso login?
   â”‚  â”œâ”€ ğŸ”— https://d-906617ed8b.awsapps.com/start/#/device
   â”‚  â”œâ”€ ğŸ”‘ VZBT-KJGT
   â”‚  â””â”€ âœ“ authenticated
   â”‚
   â”œâ”€ which account?
   â”‚  â”œâ”€ options
   â”‚  â”‚  â””â”€ 1. 805192865516 Â· ehmpathy-demo
   â”‚  â””â”€ choice
   â”‚     â””â”€ 1 âœ“
   â”‚
   â”œâ”€ which role?
   â”‚  â”œâ”€ options
   â”‚  â”‚  â””â”€ 1. ehmpathy-demo-sso
   â”‚  â””â”€ choice
   â”‚     â””â”€ 1 âœ“
   â”‚
   â”œâ”€ what should we call it?
   â”‚  â”œâ”€ suggested
   â”‚  â”‚  â””â”€ ehmpathy.demo
   â”‚  â””â”€ choice
   â”‚     â””â”€ ehmpathy.demo âœ“
   â”‚
   â”œâ”€ lovely, lets vault it now...
   â”‚  â””â”€ âœ“ written to ~/.aws/config
   â”‚
   â””â”€ perfect, now lets verify...
      â”œâ”€ âœ“ unlock
      â”œâ”€ âœ“ get
      â””â”€ âœ“ relock

ğŸ” keyrack set (org: ehmpathy, env: test)
   â””â”€ ehmpathy.test.AWS_PROFILE
      â”œâ”€ mech: EPHEMERAL_VIA_AWS_SSO
      â””â”€ vault: aws.iam.sso
```

**requirements**:
1. two separate trees â€” setup flow, then summary
2. emoji anchor at each root (ğŸ”)
3. 3 space indent from root
4. question-style headers preserved (`which X?`)
5. `â”‚` newline before each `â”œâ”€` section (whitespace separation)
6. browser auth stays inside tree (no break-out)
7. explicit `options` and `choice` subbranches under question headers
8. `âœ“` for success and choice confirmation, `âœ—` for failure
9. friendly vault header: "lovely, lets vault it now..."
10. friendly verification header: "perfect, now lets verify..."

## sources

- [aws cli sso configuration](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html)
- [aws cli sso login reference](https://docs.aws.amazon.com/cli/latest/reference/sso/login.html)
- [declastruct-aws config](https://github.com/ehmpathy/declastruct-aws/blob/main/provision/aws.auth/readme.md)
