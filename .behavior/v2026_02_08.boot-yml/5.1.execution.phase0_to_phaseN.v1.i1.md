# execution: boot.yml for role context curation

## progress tracker

---

## phase 0: preparation

### prereqs
- [x] read `.behavior/v2026_02_08.boot-yml/3.3.blueprint.v1.i1.md` (blueprint)
- [x] read `.behavior/v2026_02_08.boot-yml/1.vision.md` (vision)

### verification
- [x] understand the two modes: simple vs subject
- [x] understand say vs ref semantics
- [x] understand overlap dedupe and say-wins-over-ref precedence

---

## phase 1: domain objects

### prereqs
- [x] read `.behavior/v2026_02_08.boot-yml/3.1.research.domain._.v1.i1.md` (domain research)
- [x] read `.behavior/v2026_02_08.boot-yml/3.1.research.patterns._.code.prod.v1.i1.md` (prod patterns)

### tasks

- [ ] **1.1** create `src/domain.objects/RoleBootSpec.ts`
  - [ ] define `schemaResourceCuration` (zod schema for say/ref arrays)
  - [ ] define `schemaRoleBootSpecSimplified` (simple mode schema)
  - [ ] define `schemaSubjectSection` (subject section schema)
  - [ ] define `schemaRoleBootSpecSubjected` (subject mode schema with catchall)
  - [ ] define `RoleBootSpecSimplified` interface and class
  - [ ] define `RoleBootSpecSubjected` interface and class
  - [ ] define `RoleBootSpec` discriminated union type

- [ ] **1.2** create `src/domain.objects/RoleBootSpec.test.ts`
  - [ ] test simple mode schema validation (valid cases)
  - [ ] test simple mode schema validation (invalid cases)
  - [ ] test subject mode schema validation (valid cases)
  - [ ] test subject mode schema validation (invalid cases)

- [ ] **1.3** extend `src/domain.objects/RoleManifest.ts`
  - [ ] add optional `boot?: { uri: string }` field

### verification
```sh
npm run test:unit -- RoleBootSpec.test.ts
npm run test:types
```
- [ ] all unit tests pass
- [ ] no type errors

---

## phase 2: domain operations — parse and detect

### prereqs
- [ ] phase 1 complete

### tasks

- [ ] **2.1** create `src/domain.operations/boot/computeBootMode.ts`
- [ ] **2.2** create `src/domain.operations/boot/computeBootMode.test.ts`
- [ ] **2.3** create `src/domain.operations/boot/parseRoleBootYaml.ts`
- [ ] **2.4** create `src/domain.operations/boot/parseRoleBootYaml.test.ts`

### verification
- [ ] all unit tests pass
- [ ] no type errors

---

## phase 3: domain operations — glob filter and plan

### prereqs
- [ ] phase 2 complete

### tasks

- [ ] **3.1** create `src/domain.operations/boot/filterBootResourcesByGlob.ts`
- [ ] **3.2** create `src/domain.operations/boot/filterBootResourcesByGlob.test.ts`
- [ ] **3.3** create `src/domain.operations/boot/computeBootPlan.ts`
- [ ] **3.4** create `src/domain.operations/boot/computeBootPlan.test.ts`

### verification
- [ ] all unit tests pass
- [ ] no type errors

---

## phase 4: integration — bootRoleResources

### prereqs
- [ ] phase 3 complete

### tasks

- [ ] **4.1** extend `src/domain.operations/invoke/bootRoleResources.ts`
- [ ] **4.2** create `src/domain.operations/invoke/bootRoleResources.integration.test.ts`

### verification
- [ ] all integration tests pass
- [ ] no type errors

---

## phase 5: cli — usecase option

### prereqs
- [ ] phase 4 complete

### tasks

- [ ] **5.1** extend `src/contract/cli/invokeRolesBoot.ts`

### verification
- [ ] `--usecase` option appears in help
- [ ] build succeeds

---

## phase 6: test fixtures

### prereqs
- [ ] phase 5 complete

### tasks

- [ ] **6.1** create `accept.blackbox/.test/assets/with-boot-yaml-simple/`
- [ ] **6.2** create `accept.blackbox/.test/assets/with-boot-yaml-subject/`
- [ ] **6.3** create `accept.blackbox/.test/assets/with-boot-yaml-subject-no-always/`
- [ ] **6.4** create `accept.blackbox/.test/assets/with-boot-yaml-mixed/`
- [ ] **6.5** update `accept.blackbox/.test/infra/genTestTempRepo.ts`

### verification
- [ ] all 4 fixture directories exist with correct structure

---

## phase 7: acceptance tests

### prereqs
- [ ] phase 6 complete

### tasks

- [ ] **7.1** create `accept.blackbox/cli/roles.boot.bootyaml.acceptance.test.ts`
  - [ ] simple mode tests (cases 1-7)
  - [ ] subject mode briefs tests (cases 8-17)
  - [ ] subject mode skills tests (cases 18-25)
  - [ ] always absent tests (cases 26-27)
  - [ ] output structure tests (cases 28-33)
  - [ ] error mode tests (cases 34-35)

### verification
- [ ] all 35 acceptance tests pass

---

## phase 8: final verification

### prereqs
- [ ] all previous phases complete

### tasks

- [ ] **8.1** run full test suite
- [ ] **8.2** manual smoke test
- [ ] **8.3** verify stats output shows say/ref breakdown

### verification
- [ ] all tests pass
- [ ] manual smoke tests work as expected
- [ ] stats show say vs ref counts
