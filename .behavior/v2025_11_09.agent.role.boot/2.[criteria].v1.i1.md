# BDD Criteria: Agent Role Boot

## Core Behavior

given(a rhachet-enabled repository)
  when([t0] nochange)
    then(.agent/ directory may or may not exist)
    then(roles have not been linked or booted)
    then(briefs.link and briefs.boot commands operate on old structure)

  when([t1] npx rhachet roles link --repo $repo --role $role is executed)
    sothat(agents can access curated skills and briefs for that role)
      then(.agent/readme.md is findserted with standard glossary)
      then(.agent/repo=.this/readme.md is findserted)
      then(.agent/repo=$repo/role=$role/readme.md is upserted)
      then(.agent/repo=$repo/role=$role/briefs/* are upserted from source)
      then(.agent/repo=$repo/role=$role/skills/* are upserted from source)
    sothat(directory structure is self-documenting)
      then(repo=.this denotes docs scoped to the current @gitroot repo)
      then(repo=$repo denotes docs scoped to any rhachet repo)

  when([t2] npx rhachet roles boot --repo $repo --role $role is executed)
    sothat(agents understand available capabilities without implementation details)
      then(briefs are displayed to agent)
      then(skills documentation is displayed to agent)
      then(skills implementation is NOT displayed to agent)
    sothat(both human and robot agents can orient themselves)
      then(output is readable by human agents)
      then(output is parseable by robot agents)

  when([t3] briefs.link command is executed)
    sothat(backward compatibility is maintained)
      then(links to/from .agent/repo=$repo/role=$role/briefs directory)
      then(behavior is equivalent to roles link for briefs only)

  when([t4] briefs.boot command is executed)
    sothat(backward compatibility is maintained)
      then(boots from .agent/repo=$repo/role=$role/briefs directory)
      then(behavior is equivalent to roles boot for briefs only)

## .agent/ Directory Structure

given(.agent/ directory exists in repository)
  when([t0] nochange)
    then(.agent/readme.md contains standard glossary)
    then(glossary defines: agents, actors, roles, skills, briefs, brain)

  when([t1] directory contains skills)
    sothat(common tasks can be executed reliably)
      then(skills are .sh commands for repo-specific tasks)
      then(skills include examples like "start service and healthcheck")
      then(skills include examples like "apply terraform without remembering paths")
      then(skills are executable mechanisms producing curated effects)

  when([t2] directory contains briefs)
    sothat(agents understand repo concepts)
      then(briefs are documentation resources)
      then(briefs externalize knowledge of curated concepts)
      then(briefs include examples like "code styles")
      then(briefs include examples like "domain knowledge")

  when([t3] roles are properly structured)
    sothat(roles are portable, composable, and evolvable)
      then(roles can be linked from any rhachet repo)
      then(robot agent brains can use your skills)
      then(your skills can use robot agent brains)
      then(human agents can use the same skills)

## Standard Glossary

given(.agent/readme.md is findserted)
  when([t0] nochange)
    then(readme contains: "this dir hosts the .skills and .briefs useful to any agent, human or robot, when at work in this repo")
    then(readme defines repo=this scope)
    then(readme defines repo=$repo scope)

  when([t1] glossary is included)
    then(agents = actors w/ delegated authority)
    then(actors = roles w/ repl)
    then(roles = coherent collections of skills and briefs)
    then(skills = mechanisms that can be executed to produce curated effects)
    then(briefs = resources that externalize knowledge of curated concepts)
    then(brain = a human or robot imagination machine)
    then(brain examples include robot:llama:openai.o4)
    then(brain examples include robot:agent:claude.sonnet.v4_5)
    then(brain examples include human:agent:you)
