# feedback response: brain-continue phase 5

## prior checklist (v1)

- [x] blocker.1: abstract continuation logic into `genBrainContinuables({ for, on, with })`
- [x] nitpick.2: rename BrainChoiceSlug -> BrainGrain with .what/.why docs
- [x] blocker.3: use `exid` consistently (not `epid` or `srid`)
- [x] blocker.4: improve BrainEpisode description per terms brief
- [x] blocker.5: put exid below hash in BrainEpisode and BrainSeries
- [x] blocker.6: move tests to true blackbox acceptance tests with demo brain fixture
- [x] blocker.7: use .toEqual for deterministic hash values
- [x] blocker.8: remove unnecessary non-null assertions for repl series
- [x] blocker.9: use hash-fns instead of adhoc hash functions
- [x] blocker.10: rename folder brainEpisode -> brainContinuation

---

## current checklist (v2)

- [x] blocker.0: split acceptance tests (repl vs atom) + eliminate failhides
  - status: **done** (prior session)
  - `accept.blackbox/sdk/brainAtom.continuation.acceptance.test.ts`
  - `accept.blackbox/sdk/brainRepl.continuation.acceptance.test.ts`

- [x] blocker.1: move exchange generation into genBrainContinuables
  - status: **done**
  - callers now pass `with: { exchange: { input, output, exid } }` instead of pre-built BrainExchange
  - genBrainContinuables calls genBrainExchange internally
  - updated: genMockedBrainAtom.ts, genMockedBrainRepl.ts, genBrainContinuables.test.ts
  - removed: genMockedBrainExchange.ts (no longer needed)

- [x] blocker.2: make compute*Hash functions async for cross-platform portability
  - status: **done**
  - changed: `asHashSha256Sync` ‚Üí `asHashSha256` (async)
  - propagated async through:
    - computeBrainExchangeHash.ts
    - computeBrainEpisodeHash.ts
    - computeBrainSeriesHash.ts
    - genBrainExchange.ts
    - genBrainEpisode.ts
    - genBrainSeries.ts
    - genBrainContinuables.ts
    - asBrainOutput.ts
    - genMockedBrainOutput.ts
    - genMockedBrainEpisode.ts
    - genMockedBrainSeries.ts

- [x] blocker.3: use Pick<> types for minimal input requirements
  - status: **done**
  - genBrainEpisode: `Pick<BrainEpisode, 'exchanges'>`
  - genBrainSeries: `Pick<BrainSeries, 'episodes'>`
  - genBrainContinuables: `Pick<BrainEpisode, 'exchanges'>`, `Pick<BrainSeries, 'episodes'>`
  - computeBrainEpisodeHash: `Pick<BrainExchange, 'hash'>[]`
  - computeBrainSeriesHash: `Pick<BrainEpisode, 'hash'>[]`

- [x] blocker.4: type-safe overloads for genBrainContinuables
  - status: **done**
  - genBrainContinuables now uses function overloads:
    - `grain: 'atom'` ‚Üí returns `{ episode: BrainEpisode; series: null }`
    - `grain: 'repl'` ‚Üí returns `{ episode: BrainEpisode; series: BrainSeries }`
  - removed: `as` type assertions from implementation (clean types)
  - removed: runtime `UnexpectedCodePathError` check from genMockedBrainRepl.ts
  - types guarantee series is never null for 'repl' grain at compile time

---

## execution log

| item | status | notes |
|------|--------|-------|
| v1 blockers | done | completed in prior sessions |
| blocker.0 (v2) | done | acceptance tests split, failhides eliminated |
| blocker.1 (v2) | done | exchange generation now inside genBrainContinuables |
| blocker.2 (v2) | done | all hash functions async, propagated through chain |
| blocker.3 (v2) | done | Pick<> types for minimal input requirements |
| blocker.4 (v2) | done | type-safe overloads for genBrainContinuables |

---

## test results

```
unit tests:     97 suites, 853 passed, 2 skipped
acceptance:     18 suites, 219 passed, 8 skipped
types:          ‚úì passed
```

all blockers resolved. ready for review üê¢
