# usecase.1 = get briefs by name for a linked role

given('a role is linked into .agent/ directory')
  when('getRoleBriefs is called with role name and brief names')
    then('returns Artifact<typeof GitFile>[] for each matching brief')
      sothat('caller can use briefs without loading them into memory upfront')
    then('briefs are located from .agent/repo=$repo/role=$role/briefs/')
      sothat('caller receives briefs from the linked role structure')

given('a role is linked into .agent/ directory')
  when('getRoleBriefs is called with role name and brief glob pattern')
    then('returns Artifact<typeof GitFile>[] for all briefs matching the glob')
      sothat('caller can retrieve multiple related briefs with a single pattern')


# usecase.2 = disambiguate roles with same name across registries

given('multiple roles exist with the same name across different repos')
  when('getRoleBriefs is called with role name only')
    then('returns error indicating ambiguous role match')
      sothat('caller knows to provide repo filter for disambiguation')

given('multiple roles exist with the same name across different repos')
  when('getRoleBriefs is called with role name and repo filter')
    then('returns briefs only from the role in the specified repo')
      sothat('caller can target exact role when names collide')


# usecase.3 = handle missing or unlinked roles

given('no role with the specified name is linked')
  when('getRoleBriefs is called')
    then('returns error indicating role not found')
      sothat('caller knows the role is not available')

given('a role exists in registry but is not linked into .agent/')
  when('getRoleBriefs is called')
    then('returns error indicating role not linked')
    then('error message reminds caller to run npm run build && npx rhachet role link')
      sothat('caller knows how to make the role available')


# usecase.4 = handle missing briefs

given('a role is linked into .agent/ directory')
  when('getRoleBriefs is called with brief name that does not exist')
    then('returns error indicating brief not found for that role')
      sothat('caller knows the specific brief is not registered')

given('a role is linked into .agent/ directory')
  when('getRoleBriefs is called with glob pattern that matches no briefs')
    then('returns empty array')
      sothat('caller can handle zero-match case gracefully')


# usecase.5 = compose roles using briefs from other roles

given('a role procedure needs briefs from another linked role')
  when('getRoleBriefs is called within that procedure')
    then('returns briefs as Artifact<typeof GitFile>[]')
      sothat('procedure can pass briefs to brain.repl.imagine or other consumers')
    then('briefs are returned without being loaded into memory')
      sothat('callers control when and how brief content is read')
