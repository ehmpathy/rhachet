# roadmap: rhx alias implementation

## overview

5 phases, ordered by dependency. each phase includes acceptance criteria and verification.

---

## phase 0: create bin/rhx shell proxy

**read before**:
- `.behavior/v2026_01_27.rhx/3.1.research.claims._.v1.i1.md` (shell wrapper best practices)
- `.behavior/v2026_01_27.rhx/3.1.research.patterns._.code.prod.v1.i1.md` (prod patterns)

### tasks

- [ ] create `bin/rhx` shell proxy
  ```sh
  #!/bin/sh
  exec rhachet run --skill "$@"
  ```
- [ ] make executable: `chmod +x bin/rhx`

### acceptance criteria

- [ ] `bin/rhx` exists and is executable
- [ ] `./bin/rhx say-hello` (from repo root) produces same output as `./bin/run run --skill say-hello`

### verification

```sh
# from repo root with linked roles
chmod +x bin/rhx
./bin/rhx say-hello
./bin/run run --skill say-hello
# compare outputs
```

---

## phase 1: extend package.json bin entry

**read before**:
- `.behavior/v2026_01_27.rhx/3.1.research.claims._.v1.i1.md` (npm bin field)

### tasks

- [ ] add `rhx` to bin field in package.json
  ```json
  "bin": {
    "rhachet": "./bin/run",
    "rhx": "./bin/rhx"
  }
  ```

### acceptance criteria

- [ ] package.json bin field includes both `rhachet` and `rhx`
- [ ] `npm pack` includes bin/rhx in tarball

### verification

```sh
# verify bin field
cat package.json | jq '.bin'

# verify tarball includes bin/rhx
npm pack --dry-run 2>&1 | grep 'bin/rhx'
```

---

## phase 2: extend test infrastructure

**read before**:
- `.behavior/v2026_01_27.rhx/3.1.research.patterns._.code.test.v1.i1.md` (test patterns)

### tasks

- [ ] extend `invokeRhachetCliBinary` to support `binary` param
  ```ts
  export const invokeRhachetCliBinary = (input: {
    binary?: 'rhachet' | 'rhx';
    args: string[];
    cwd: string;
    // ...
  }) => { ... }
  ```

### acceptance criteria

- [ ] `invokeRhachetCliBinary({ binary: 'rhx', args: ['say-hello'], cwd })` invokes bin/rhx
- [ ] default behavior unchanged (binary defaults to 'rhachet')

### verification

```sh
npm run test:acceptance -- invokeRhachetCliBinary
```

---

## phase 3: create acceptance tests

**read before**:
- `.behavior/v2026_01_27.rhx/2.criteria.blackbox.md` (blackbox criteria)
- `.behavior/v2026_01_27.rhx/3.1.research.patterns._.code.test.v1.i1.md` (test patterns)

### tasks

- [ ] create `accept.blackbox/cli/rhx.acceptance.test.ts`
- [ ] test case 1: rhx produces identical output to rhachet run --skill
- [ ] test case 2: rhx argument passthrough works
- [ ] test case 3: rhx error output matches rhachet run --skill errors

### acceptance criteria

- [ ] all tests pass: `npm run test:acceptance -- rhx.acceptance`
- [ ] tests verify equivalence (rhx === rhachet run --skill)

### verification

```sh
npm run test:acceptance -- rhx.acceptance.test.ts
```

---

## phase 4: update readme

**read before**:
- `.behavior/v2026_01_27.rhx/2.criteria.blackbox.md` (usecase.4: readme documents rhx)

### tasks

- [ ] add rhx section to readme.md
  - document `rhx` as shorthand for `rhachet run --skill`
  - show example: `npx rhx say-hello`
  - explain equivalence: `rhx <skill>` === `rhachet run --skill <skill>`
- [ ] update installation section
  - note that both `rhachet` and `rhx` become available after global install

### acceptance criteria

- [ ] readme mentions `rhx` as shorthand
- [ ] readme shows example usage
- [ ] readme explains relationship to `rhachet run --skill`

### verification

```sh
# manual review of readme.md
grep -A5 'rhx' readme.md
```

---

## phase 5: final verification

**read before**:
- `.behavior/v2026_01_27.rhx/2.criteria.blackbox.md` (all usecases)
- `.behavior/v2026_01_27.rhx/2.criteria.blueprint.md` (all contracts)

### tasks

- [ ] run full test suite
- [ ] verify all blackbox criteria satisfied
- [ ] verify all blueprint contracts satisfied

### acceptance criteria

- [ ] `npm run test` passes
- [ ] `npm run test:acceptance` passes
- [ ] manual verification of each usecase in blackbox criteria

### verification

```sh
npm run test
npm run test:acceptance

# manual verification
npm link
rhx say-hello
rhachet run --skill say-hello
# compare outputs
```

---

## dependency graph

```
phase 0 (bin/rhx)
    │
    ▼
phase 1 (package.json)
    │
    ▼
phase 2 (test infra)
    │
    ▼
phase 3 (acceptance tests)
    │
    ▼
phase 4 (readme)
    │
    ▼
phase 5 (final verification)
```

---

## estimated scope

| phase | files touched | complexity |
|-------|---------------|------------|
| 0 | 1 | trivial (3 lines) |
| 1 | 1 | trivial (1 line) |
| 2 | 1 | low (add param) |
| 3 | 1 | medium (new test file) |
| 4 | 1 | low (docs) |
| 5 | 0 | verification only |

**total**: 5 files touched, low overall complexity
