# blackbox criteria matrix: keyrack init --owner

## matrix.1 = init command outcomes

| ind: manifest exists | dep: effect | dep: output message |
|---------------------|-------------|---------------------|
| no                  | created     | "freshly minted"    |
| yes                 | found       | "found"             |

## matrix.2 = set command outcomes

| ind: manifest exists | dep: key stored | dep: error |
|---------------------|-----------------|------------|
| yes                 | yes             | none       |
| no                  | no              | "manifest not found" + tip |

## matrix.3 = get command isolation

| ind: key in default | ind: key in custom | ind: --owner flag | dep: result |
|--------------------|-------------------|-------------------|-------------|
| yes                | no                | omitted           | found (default value) |
| yes                | no                | custom            | not found   |
| no                 | yes               | omitted           | not found   |
| no                 | yes               | custom            | found (custom value) |
| yes                | yes               | omitted           | found (default value) |
| yes                | yes               | custom            | found (custom value) |
| no                 | no                | omitted           | not found   |
| no                 | no                | custom            | not found   |

## matrix.4 = --owner flag support by command

| ind: command       | dep: --owner supported | dep: --for alias |
|-------------------|------------------------|------------------|
| init              | yes                    | yes              |
| set               | yes                    | yes              |
| get               | yes                    | yes              |
| status            | yes                    | yes              |
| recipient set     | yes                    | yes              |

## matrix.5 = vault path structure by owner

| ind: vault type | ind: owner    | dep: path pattern                              |
|-----------------|---------------|------------------------------------------------|
| os.direct       | default       | `os.direct/owner=default/keyrack.direct.json`  |
| os.direct       | custom        | `os.direct/owner={owner}/keyrack.direct.json`  |
| os.secure       | default       | `os.secure/owner=default/{hash}.age`           |
| os.secure       | custom        | `os.secure/owner={owner}/{hash}.age`           |
| os.daemon       | default       | `$XDG_RUNTIME_DIR/keyrack.{sessionId}.sock`           |
| os.daemon       | custom        | `$XDG_RUNTIME_DIR/keyrack.{sessionId}.{owner}.sock`   |

## matrix.6 = status command isolation

| ind: keys in default | ind: keys in custom | ind: --owner flag | dep: shows keys for |
|---------------------|---------------------|-------------------|---------------------|
| yes                 | no                  | omitted           | default only        |
| yes                 | no                  | custom            | none (custom empty) |
| no                  | yes                 | omitted           | none (default empty)|
| no                  | yes                 | custom            | custom only         |
| yes                 | yes                 | omitted           | default only        |
| yes                 | yes                 | custom            | custom only         |

---

## gaps identified

none â€” all combinations are covered by the blackbox criteria.

## decomposition notes

the matrices are appropriately scoped:
- each matrix has 2-3 independent dimensions
- no matrix exceeds reasonable enumeration
- concerns are well-separated (init vs set vs get vs status vs vault paths)
