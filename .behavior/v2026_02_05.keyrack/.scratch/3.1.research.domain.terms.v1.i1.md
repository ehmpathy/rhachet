# domain terms research: rhachet/keyrack

> research on terminology for the keyrack feature's domain objects

---

## 1. domain objects identified

from the wish and vision, these domain objects need naming:

### entities (have identity, lifecycle)

| concept | description |
|---------|-------------|
| **credential config entry** | per-key config stored in `~/.rhachet/keyrack.config.json` — maps a key name to a vault + metadata |
| **repo key requirement** | per-key entry in `.agent/keyrack.yml` — declares what mechanism a key requires |

### literals (value objects, immutable)

| concept | description |
|---------|-------------|
| **vault type** | where credentials are stored: `os.direct`, `os.secure`, `1password` |
| **mechanism type** | how to translate credentials: `REPLICA`, `GITHUB_APP`, `AWS_SSO` |
| **resolution status** | outcome of a get operation: granted, not_found, locked, blocked |
| **granted value** | the resolved, short-lived credential ready for use |

### events

| concept | description |
|---------|-------------|
| **credential granted** | a credential was successfully resolved and exported |
| **vault unlocked** | a vault backend was authenticated |
| **credential blocked** | a credential violated its mechanism constraint |

---

## 2. industry terminology research

### 2.1 password management & vaults

> "password vaulting refers to the practice of securely storing and managing digital credentials... within a centralized, encrypted repository. this repository, often referred to as a password manager or a password safe, protects these credentials from unauthorized access" [1]

> "keyrack is an os-based password manager where users log into the os to unlock the vault" [1]

> "enterprise password vault provides secure management of privileged credentials. hashicorp vault enterprise provides secure secrets management and api-based credential handling" [1]

**key terms from this domain**:
- **vault** — encrypted storage container
- **keyrack** — os-integrated credential store
- **secret** — a stored credential
- **master password** — key to unlock the vault

### 2.2 hashicorp vault & aws secrets manager

> "secrets engines are flexible plugins that provide a standard api and cli access for creation, updating, reading and deleting secrets" [2]

> "the aws secrets engine generates aws access credentials dynamically based on iam policies... short-living access credentials dynamically based on iam policies" [2]

> "dynamic secrets differ from static secrets where a unique username and password pair are generated with each credential request" [2]

**key terms from this domain**:
- **secrets engine** — mechanism that generates/translates credentials
- **dynamic secrets** — generated on-demand, short-lived
- **static secrets** — long-lived, stored as-is
- **lease** — time-limited credential validity
- **rotation** — automatic credential refresh

### 2.3 physical security & access control

> "an access card is a physical credential (keycard or badge) used for entry. an access control system (acs) manages who can enter where and when" [3]

> "proximity cards... use rfid technology to communicate with a reader without requiring physical contact" [3]

> "mobile credentials: with mobile access, employees can enter secure areas using their smartphones, eliminating the need for physical badges or keycards" [3]

**key terms from this domain**:
- **keycard** — physical access credential
- **badge** — identity + access credential
- **credential** — any proof of authorization
- **reader** — validates credentials
- **access control** — policy enforcement

### 2.4 oauth & authorization

> "access tokens are artifacts that allow application systems to perform the authorization and authentication process" [4]

> "the grant type basically refers to the way your app gets the access token. oauth 2.0 offers different types of grant types" [4]

> "refresh tokens are credentials used to obtain access tokens... when the current access token becomes invalid or expires" [4]

**key terms from this domain**:
- **grant** — the act of issuing an access token
- **grant type** — mechanism for obtaining tokens
- **access token** — short-lived authorization
- **refresh token** — long-lived credential for obtaining new access tokens

### 2.5 locksmith & physical keys

> "the lock cylinder is the part of the lock that the key is inserted into. it interacts with the locking mechanism to either lock or unlock the door" [5]

> "the keyway is the specific shape or design of the hole in a lock cylinder where the key is inserted" [5]

> "any key that operates two or more unique locks can be called a master key" [5]

**key terms from this domain**:
- **cylinder** — contains the locking mechanism
- **keyway** — specific shape that determines which keys fit
- **master key** — universal access key

### 2.6 banking vaults & safe deposit

> "safe deposit boxes are protected under dual access control, hence the deposit lock requires two keys from different holders. the key to unlock the guard nose side is called the 'guard key' which is kept and maintained by bank employees. the renter key is the key held by the renter of the box" [6]

> "a bank vault is a secure room used by banks to store and protect valuables... typically made of reinforced concrete and steel, with complex locking mechanisms" [6]

**key terms from this domain**:
- **vault** — secure storage room
- **safe deposit box** — individual secure container within vault
- **guard key** — institutional access key
- **renter key** — customer access key
- **dual access control** — requires two keys

### 2.7 valet & coat check

> "coat and claim tickets are designed to streamline coat check processes, with each ticket featuring a tear-off stub and a claim stub for smooth coordination" [7]

> "valet parking tickets typically consist of 3 parts: a key stub with a hole to attach to a key-ring, a car stub, and a claim check with printed liability disclaimer" [7]

**key terms from this domain**:
- **claim check** — customer's proof of deposit
- **stub** — portion retained by service
- **claim** — act of retrieving deposited item
- **voucher** — redeemable token

### 2.8 pharmacy & controlled substances

> "dispensing includes all the steps necessary to translate a medication order, or prescription, into an individualized medication supply" [8]

> "for a pharmacist to dispense a controlled substance, the prescription must include specific information to be considered valid" [8]

> "schedule ii medications may not be refilled; a new prescription must be written every time" [8]

**key terms from this domain**:
- **dispense** — translate prescription → medication
- **prescription** — authorized request for medication
- **schedule** — classification of control level
- **refill** — subsequent dispensing from same authorization

### 2.9 hotel keycards

> "a hotel key card is a credit card-sized access and security tool that lets guests into their rooms... also called a hotel room card, hotel card key or room key card" [9]

> "a mobile key in the hotel industry refers to a digital key that guests can use to access their hotel rooms via a smartphone app, which replaces traditional physical keys" [9]

**key terms from this domain**:
- **room key** — access credential for guest
- **mobile key** — digital/phone-based access
- **key card** — physical RFID/mag-stripe credential

### 2.10 kubernetes secrets

> "external secrets operator is a kubernetes operator that integrates external secret management systems... the operator reads information from external apis and automatically injects the values into a kubernetes secret" [10]

> "eso is a collection of custom api resources - externalsecret, secretstore and clustersecretstore that provide a user-friendly abstraction" [10]

**key terms from this domain**:
- **external secret** — reference to a secret in an external system
- **secret store** — configuration of where secrets live
- **sealed secret** — encrypted secret safe for git

---

## 3. relationship analysis

### 3.1 treestruct of decoration

```
keyrack (system)
├── vault (storage backend)
│   ├── os.direct
│   ├── os.secure
│   └── 1password
├── mechanism (translation adapter)
│   ├── REPLICA
│   ├── GITHUB_APP
│   └── AWS_SSO
└── resolution (outcome)
    ├── granted
    ├── not_found
    ├── locked
    └── blocked
```

### 3.2 dependencies

```
repo manifest (.agent/keyrack.yml)
    declares → key requirements (name + mechanism)
                    ↓
machine config (~/.rhachet/keyrack.config.json)
    maps → key name → vault reference
                    ↓
vault backend
    stores → raw credential
                    ↓
mechanism adapter
    translates → raw → short-lived
                    ↓
resolution
    grants → exported value
```

---

## 4. naming proposals

### 4.1 the main system

| option | source domain | pros | cons |
|--------|---------------|------|------|
| **keyrack** | apple, password managers | well-known, implies key collection | could confuse with macos keyrack |
| **vault** | hashicorp, banking | implies security, industry standard | conflicts with storage backend name |
| **locker** | physical security | clear metaphor | less common in software |

**recommendation**: keep **keyrack** — it's established in the wish and maps well to the "collection of keys" metaphor. the firewall behavior distinguishes it from simple password managers.

### 4.2 a single credential entry

| option | source domain | pros | cons |
|--------|---------------|------|------|
| **key** | locksmith, current | simple, intuitive | overloaded (ssh key, api key, etc.) |
| **secret** | hashicorp, k8s | industry standard | implies the value, not the config |
| **credential** | access control | precise, unambiguous | verbose |
| **entry** | 1password | generic, flexible | too generic |
| **slot** | keyrack metaphor | implies position in keyrack | unfamiliar |

**recommendation**: use **credential** for the domain object (e.g., `KeyrackCredential`), but allow `--key` in cli for brevity. the domain object represents the configuration, not the secret value itself.

alternatively, consider **ring** — as in "key ring" — each credential is a ring on the keyrack.

### 4.3 the storage backend

| option | source domain | pros | cons |
|--------|---------------|------|------|
| **vault** | hashicorp, banking | well-known, secure connotation | term overload with hashicorp vault |
| **store** | k8s secretstore | simple | generic |
| **locker** | physical | clear metaphor | less common |
| **safe** | banking | implies security | less common in software |
| **strongbox** | physical security | unique, memorable | unfamiliar |

**recommendation**: keep **vault** — it's the most established term. hashicorp owns "vault" the product, but "vault" the concept is generic. the vision already uses it consistently.

### 4.4 the translation mechanism

| option | source domain | pros | cons |
|--------|---------------|------|------|
| **mech** | current wish | short, unique | unfamiliar abbreviation |
| **mechanism** | current wish | full word | long |
| **engine** | hashicorp secrets engine | industry precedent | could imply more than translation |
| **grant** | oauth grant type | authorization semantics | slightly different meaning |
| **resolver** | dns, general | implies translation | could imply lookup only |
| **adapter** | design pattern | implies translation | technical jargon |

**recommendation**: keep **mechanism** (abbrev: **mech**) — it's descriptive and doesn't conflict with oauth "grant" semantics. "engine" is a close second but implies a running process.

### 4.5 the resolved output value

| option | source domain | pros | cons |
|--------|---------------|------|------|
| **grant** | oauth | implies authorized access | overloaded with verb "to grant" |
| **keycard** | hotel, access control | matches vision metaphor | specific to physical access |
| **pass** | transit, hotel | short, implies access | too generic |
| **token** | oauth | industry standard | overloaded (jwt, access token, etc.) |
| **claim check** | coat check | unique metaphor | unfamiliar |
| **ticket** | valet | implies redeemable access | event-oriented connotation |

**recommendation**: consider **pass** or **grant** — the vision uses "keycard" metaphorically but the actual value is a token/credential. **grant** has nice verb/noun duality: "the keyrack grants a grant."

alternative: **keycard** as the metaphorical term in docs, **grant** as the domain object.

### 4.6 the per-repo manifest

| option | source domain | pros | cons |
|--------|---------------|------|------|
| **manifest** | current vision | standard software term | generic |
| **declaration** | typescript | implies static definition | verbose |
| **claim** | k8s, coat check | implies request for resource | could confuse with jwt claim |
| **requisition** | procurement | formal request semantics | bureaucratic |
| **spec** | k8s | standard in declarative systems | generic |

**recommendation**: keep **manifest** — it's already used in the vision and maps well to declarative configuration.

### 4.7 the resolution status

current vision uses: `granted`, `not_found`, `locked`, `blocked`

| current | alternative | rationale |
|---------|-------------|-----------|
| granted | issued, passed, resolved | "granted" has authorization connotation ✓ |
| not_found | missing, absent, unconfigured | "not_found" is precise ✓ |
| locked | sealed, secured | "locked" maps to vault metaphor ✓ |
| blocked | denied, rejected, forbidden | "blocked" implies policy enforcement ✓ |

**recommendation**: keep current terms — they're intuitive and map well to the firewall metaphor.

---

## 5. proposed domain vocabulary

### primary terms

| concept | term | rationale |
|---------|------|-----------|
| the system | **keyrack** | established, implies key collection |
| a configured credential | **credential** | precise, industry standard |
| storage backend | **vault** | banking/security connotation |
| translation mechanism | **mechanism** (abbrev: **mech**) | descriptive, unique |
| resolved output | **grant** | oauth parallel, verb/noun duality |
| per-repo declaration | **manifest** | standard declarative term |
| machine-level config | **config** | standard |

### status terms

| status | meaning |
|--------|---------|
| **granted** | resolved successfully, exported to env |
| **not_found** | not configured on this machine |
| **locked** | vault requires authentication |
| **blocked** | value violates mechanism constraint |

### vault types

| vault | storage characteristics |
|-------|------------------------|
| **os.direct** | plaintext, no unlock required |
| **os.secure** | encrypted, os-level unlock |
| **1password** | external vault, 1password auth |

### mechanism types

| mechanism | behavior |
|-----------|----------|
| **REPLICA** | pass through (no translation possible) |
| **GITHUB_APP** | json blob → short-lived installation token |
| **AWS_SSO** | sso profile → temporary session credentials |

---

## 6. alternative naming schemes considered

### 6.1 physical key metaphor

| concept | term | source |
|---------|------|--------|
| system | **keyring** | physical key organization |
| credential | **key** | locksmith |
| vault | **lockbox** | banking |
| mechanism | **keyway** | locksmith (shape that determines fit) |
| grant | **cut** | locksmith (the specific key shape) |

pros: cohesive physical metaphor
cons: "keyway" and "cut" are unfamiliar

### 6.2 pharmacy metaphor

| concept | term | source |
|---------|------|--------|
| system | **dispenser** | pharmacy |
| credential | **prescription** | pharmacy |
| vault | **cabinet** | controlled substances |
| mechanism | **schedule** | controlled substance classification |
| grant | **dose** | dispensed medication |

pros: strong controlled-access semantics
cons: medication connotation could be confusing

### 6.3 coat check metaphor

| concept | term | source |
|---------|------|--------|
| system | **checkroom** | hospitality |
| credential | **claim** | coat check |
| vault | **locker** | storage |
| mechanism | **ticket type** | valet/coat check |
| grant | **stub** | claim check |

pros: intuitive deposit/claim semantics
cons: less common in software, verbose

---

## 7. final recommendations

based on industry alignment, intuition, and the existing vision language:

### keep from current vision
- **keyrack** — well-established system name
- **vault** — standard storage backend term
- **mechanism** — unique and descriptive
- **manifest** — standard declarative term
- status terms: **granted**, **not_found**, **locked**, **blocked**

### refine or clarify
- **credential** instead of just "key" for the domain object (avoids overload with "api key", "ssh key", etc.)
- **grant** for the resolved output value (oauth parallel, clean verb/noun duality)

### domain object summary

```ts
// literals (value objects)
type VaultType = 'os.direct' | 'os.secure' | '1password';
type MechanismType = 'REPLICA' | 'GITHUB_APP' | 'AWS_SSO';
type CredentialStatus = 'granted' | 'not_found' | 'locked' | 'blocked';

// domain objects
class KeyrackCredential extends DomainEntity {
  // the per-machine config entry for a credential
  name: string;
  vault: VaultType;
  createdAt: string;
  updatedAt: string;
}

class KeyrackRequirement extends DomainLiteral {
  // the per-repo manifest entry for a required key
  name: string;
  mech: MechanismType;
}

class KeyrackGrant extends DomainLiteral {
  // the resolved, short-lived value ready for export
  name: string;
  value: string; // never persisted, ephemeral
  expiresAt?: string;
  source: { vault: VaultType; mech: MechanismType };
}

class KeyrackManifest extends DomainLiteral {
  // the full per-repo manifest
  keys: Record<string, KeyrackRequirement>;
}

class KeyrackConfig extends DomainEntity {
  // the full per-machine config
  credentials: Record<string, KeyrackCredential>;
}
```

---

## citations

1. [password vaulting terminology](https://entro.security/glossary/password-vaulting/) — entro security glossary
2. [hashicorp vault secrets engines](https://developer.hashicorp.com/vault/docs/secrets/aws) — hashicorp developer docs
3. [access control credential types](https://www.genxsecurity.com/single-post/access-control-credential-types-for-physical-security) — genx security
4. [oauth 2.0 grant types](https://frontegg.com/blog/oauth-grant-types) — frontegg
5. [locksmith terminology](https://www.mrlocksmithtraining.com/glossary/) — mr locksmith training
6. [safe deposit box terminology](https://www.kcolefas.com/en/insights/safe-deposit-box) — kcolefas
7. [coat and claim check tickets](https://www.kwiktickets.net/coat-and-claim-check/products/) — kwiktickets
8. [pharmacy prescription requirements](https://www.ncbi.nlm.nih.gov/books/NBK538424/) — ncbi statpearls
9. [hotel key cards](https://www.getkisi.com/blog/how-do-hotel-key-cards-work) — kisi
10. [external secrets operator](https://github.com/external-secrets/external-secrets) — github
